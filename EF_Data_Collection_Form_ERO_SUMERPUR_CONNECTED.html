<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>EF Data Collection — ERO SUMERPUR • AC-121 • SIR 2026</title>
<style>
  body{font-family:Arial,Helvetica,sans-serif;background:#f6f7fb;margin:0;padding:20px}
  .container{max-width:640px;margin:20px auto;background:#fff;padding:18px;border-radius:10px;box-shadow:0 6px 18px rgba(32,33,36,0.08)}
  h1{margin:0;font-size:20px;text-align:center}
  .sub{ text-align:center;color:#333;margin:6px 0 18px;font-weight:600 }
  label{display:block;margin-top:10px;font-weight:600}
  input,select{width:100%;padding:10px;margin-top:6px;border:1px solid #d0d5dd;border-radius:6px;box-sizing:border-box}
  .row{display:flex;gap:12px}
  .row > div{flex:1}
  .actions{margin-top:16px;display:flex;gap:10px}
  button{flex:1;padding:12px;border-radius:8px;border:0;background:#0b63d0;color:#fff;font-weight:700;cursor:pointer}
  button.secondary{background:#6c757d}
  .error{color:#b00020;margin-top:8px}
  .success{color:green;margin-top:8px}
  small.note{display:block;margin-top:6px;color:#444}
  @media(max-width:540px){.row{flex-direction:column}}
</style>
</head>
<body>
<div class="container">
  <h1>EF Data Collection Form</h1>
  <div class="sub">ERO SUMERPUR • AC-121 • SIR 2026</div>

  <label for="supervisor">Supervisor Name</label>
  <select id="supervisor" required>
    <option value="">-- Select Supervisor --</option>
    <option>Sh. MangiLal Dewasi</option>
    <option>Sh. Kishore Kumar Soni</option>
    <option>Sh. Bharat Lal Sharma</option>
    <option>Sh. Mahesh Sonal</option>
    <option>Sh. Chandra Kant Nanda</option>
    <option>Sh. Mankchand Sharma</option>
    <option>Sh. Vijay Kumar Jangid</option>
    <option>Sh. Bheru Singh</option>
    <option>Sh. Vikram Singh</option>
    <option>Sh. Jay Prakash</option>
    <option>Sh. Sanjay Gehlot</option>
    <option>Sh. Bajrang Singh Charan</option>
    <option>Sh. Rajesh Kumar</option>
    <option>SH. Chandan Singh Rajpurohit</option>
    <option>Sh. Inder Kumar Sain</option>
    <option>Sh. Shivlal Choudhary</option>
    <option>Sh. Kishan Lal</option>
    <option>Sh. Shankar Lal Meena</option>
    <option>Sh. Abhinav Khatri</option>
    <option>Sh. Meetha Ram</option>
    <option>Sh. Nema Ram</option>
    <option>Sh. Dalpat Singh Deora</option>
    <option>Sh. Ghisulal Borana</option>
    <option>Sh Rakesh Kumar Prajapati</option>
    <option>Sh. Naresh Kumar Parihar</option>
    <option>Sh. Bhanwar Lal Parihar</option>
    <option>Sh. Himatram Gehlot</option>
    <option>Sh. Pradeep Vaishnav</option>
    <option>Sh. Rakesh Kumar Malviya</option>
  </select>

  <label for="date">Reporting Date</label>
  <input id="date" type="date" required />

  <div class="row">
    <div>
      <label for="partNo">Part Number</label>
      <input id="partNo" type="number" min="1" max="500" required />
    </div>
    <div>
      <label for="distributed">Total EF Distributed</label>
      <input id="distributed" type="number" min="0" max="2000" required />
    </div>
  </div>

  <div class="row">
    <div>
      <label for="collected">Total EF Collected</label>
      <input id="collected" type="number" min="0" required />
    </div>
    <div>
      <label for="digitized">Total EF Digitized</label>
      <input id="digitized" type="number" min="0" required />
    </div>
  </div>

  <label for="remarks">Remarks (optional)</label>
  <input id="remarks" type="text" maxlength="250" placeholder="Problems / notes (if any)"/>

  <div class="actions">
    <button id="submitBtn">Submit</button>
    <button id="downloadBtn" class="secondary">Download CSV</button>
  </div>

  <div id="msg" class=""></div>
  <small class="note">Connected to Google Sheets via Apps Script Web App.</small>
</div>

<script>
const WEB_APP_URL = "https://script.google.com/macros/s/AKfycbxaOVABT11LAOP2MCoRPzTyB6Y8KK_Y-CXp_hBRBw1iL4maiHddYsyviyavAzq4BOhJ/exec";

function qs(id){return document.getElementById(id)}

function show(msg, cls){
  const el = qs('msg');
  el.className = cls||'';
  el.innerText = msg;
}

function validate(values){
  if(!values.supervisor) return "Please select Supervisor";
  if(!values.date) return "Please select Date";
  if(!values.partNo) return "Enter valid Part Number";
  if(isNaN(values.distributed)) return "Enter Total EF Distributed";
  if(isNaN(values.collected)) return "Enter Total EF Collected";
  if(isNaN(values.digitized)) return "Enter Total EF Digitized";

  const today = new Date(); today.setHours(0,0,0,0);
  const d = new Date(values.date);
  if(d > today) return "Future dates are not allowed";

  if(values.collected > values.distributed) return "Collected cannot be greater than Distributed";
  if(values.digitized > values.collected) return "Digitized cannot be greater than Collected";

  return "";
}

async function postData(payload){
  try{
    const res = await fetch(WEB_APP_URL, {
      method: "POST",
      mode: "cors",
      headers: {"Content-Type":"application/json"},
      body: JSON.stringify(payload)
    });
    const data = await res.json();
    return { ok:true, data };
  }catch(err){
    return { ok:false, error: err.message };
  }
}

qs('submitBtn').addEventListener('click', async function(e){
  e.preventDefault();
  show('', '');
  const payload = {
    supervisor: qs('supervisor').value.trim(),
    date: qs('date').value,
    partNo: Number(qs('partNo').value),
    distributed: Number(qs('distributed').value),
    collected: Number(qs('collected').value),
    digitized: Number(qs('digitized').value),
    remarks: qs('remarks').value.trim(),
    ts: new Date().toISOString()
  };

  const v = validate(payload);
  if(v){ show(v, 'error'); return; }

  show('Submitting...', '');
  const res = await postData(payload);
  if(res.ok){ show('Submitted successfully ✅', 'success'); }
  else {
    show('Submit failed: ' + res.error, 'error');
  }
});

</script>
</body>
</html>